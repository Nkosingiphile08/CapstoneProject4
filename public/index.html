<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>home</title>
    <script src="https://cdn.jsdelivr.net/npm/alpinejs@2.8.2/dist/alpine.js" defer></script>
    <link rel="stylesheet" href="style.css">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.1/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
</head>

<body x-data="{ 
        inputs: {
        Genetic_Pedigree_Coefficient: '',
        Age: '',
        Weight: '',
        Height: '',
        Sex: '',
        Smoking: '',
        Physical_activity: '',
        salt_content_in_the_diet: '',
        alcohol_consumption_per_day: '',
        Level_of_Stress: 'High',
        Chronic_kidney_disease: ''
    },
    results: {
        healthStatus: '',
        recommendation: ''
    }
}">
    <nav class="navbar-top">
        <div class="navbar-content">
            <ul>
                <li></li>
                <a href="index.html" class="notifications-tab"><i class="fa fa-home fa-2x"></i></a>
                <li></li>
                <li></li>
                <li></li>
                <li></li>
                <li></li>
                <li class="notifications-tab">
                    <i id="open-notifications" class="fa fa-bell fa-2x"></i>
                    <div class="notifications-content">
                        <!-- Notifications will appear here -->
                    </div>
                </li>
                <div class="menu-bar">
                    <div x-data="{ isOpen: false }">
                        <!-- Toggle button for the menu -->
                        <i @click="isOpen = !isOpen" class="fa fa-bars fa-2x"></i>
                        <!-- Menu container -->
                        <span x-show="isOpen" class="menu">
                            <!-- Menu items -->
                            <ol>
                                <i><a href="index.html">Home</a></li>
                                    <li><a href="languages.html">Languages</a></li>
                                    <li><a href="#">About</a></li>
                                    <li><a href="#">Logout</a></li>
                            </ol>
                        </span>
                    </div>
                </div>
                <li></li>
            </ul>
        </div>
    </nav>

    <section class="content">
        <h1>Hello Mandisa.</h1>
        <p>Welcome to the app, fill in the health form below to get an assessment.</p>

        <form @submit.prevent="calculateBloodPressure"></form>
        <label>Family history of hypertension:</label><br>
        <select x-model="inputs.Genetic_Pedigree_Coefficient">
            <option value="1.00 - 0.5">Yes, my parent/s is hypertensive</option>
            <option value="0.4 - 0.1">Yes, my grandparent/s are hypertensive</option>
            <option value="0.0">No</option>
        </select><br>

        <label>Age:</label><br>
        <input type="number" x-model.number="inputs.Age"><br>

        <label>Weight (kg):</label><br>
        <input type="number" x-model.number="inputs.Weight"><br>

        <label>Height (cm):</label><br>
        <input type="number" x-model.number="inputs.Height"><br>

        <label>Sex:</label><br>
        <select x-model="inputs.Sex"><br>
            <option value="Male">Male</option>
            <option value="Female">Female</option>
        </select><br>

        <label>Smoking:</label><br>
        <select x-model="inputs.Smoking">
            <option value="Yes">Yes</option>
            <option value="No">No</option>
        </select><br>

        <label>Physical Activity (minutes/day):</label><br>
        <input type="number" x-model.number="inputs.Physical_activity"><br>

        <label>Salt Content in the Diet (g/day):</label><br>
        
        <input type="number" x-model.number="inputs.salt_content_in_the_diet"><br>

        <label>Alcohol Consumption (units/day):</label><br>
        <input type="number" x-model.number="inputs.alcohol_consumption_per_day"><br>

        <label>Level of Stress:</label><br>
        <select x-model="inputs.Level_of_Stress">
            <option value="High">High</option>
            <option value="Medium">Medium</option>
            <option value="Low">Low</option>
        </select><br>

        <label>Chronic Kidney Disease:</label><br>
        <select x-model="inputs.Chronic_kidney_disease">
            <option value="Yes">Yes</option>
            <option value="No">No</option>
        </select><br>
        <br>
        <!-- <button type="submit">Calculate</button> -->
        <button x-on:click="calculateBloodPressure">
            Predict
        </button>
        </form>

    </section>
    <div x-show="results.healthStatus">
        <h2>Health Status:</h2>
        <p x-text="results.healthStatus"></p>
        <h2>Recommendation:</h2>
        <p x-text="results.recommendation"></p>
    </div>
    </section>

    <nav class="navbar-bottom">
        <div class="navbar-content">
            <ul>
                <li></li>
                <a href="bptracking.html"><i class="fa fa-heartbeat fa-2x"></i></a>
                <a href="appointment.html"><i class="fa fa-medkit fa-2x"></i></a>
                <a href="community.html"><i class="fa fa-comments-o fa-2x"></i></a>
                <li></li>
            </ul>
        </div>
    </nav>

    <script>
        // function calculateResults() {
        //     const inputs = Alpine.store('inputs');
        //     const results = Alpine.store('results');

        //     if (inputs.Age >= 18 && inputs.Age <= 50) {
        //         results.healthStatus = 'Good';
        //         results.recommendation = 'Maintain a balanced diet and exercise regularly.';
        //     } else {
        //         results.healthStatus = 'Needs assessment';
        //         results.recommendation = 'Consult a healthcare professional for a detailed assessment.';
        //     }
        // }

        // Alpine.store('calculateResults', calculateResults);
        // 
        
       
        function calculateBloodPressure() {
        const inputs = Alpine.store('inputs');
        const results = Alpine.store('results');

        // Retrieve values from form inputs
        const gender = inputs.Sex;
        const age = inputs.Age;
        const familyHistory = inputs.Genetic_Pedigree_Coefficient === '1.00 - 0.5';
        const weight = inputs.Weight;
        const height = inputs.Height;
        const smoker = inputs.Smoking === 'Yes';
        const activityMinutes = inputs.Physical_activity;
        const saltContent = inputs.salt_content_in_the_diet;
        const alcoholUnits = inputs.alcohol_consumption_per_day;
        const stressLevel = inputs.Level_of_Stress;
        const kidneyDisease = inputs.Chronic_kidney_disease === 'Yes';

        let bloodPressure;

        if (
            gender === 'Female' &&
            age <= 30 &&
            !familyHistory &&
            weight / Math.pow(height / 100, 2) < 25 && // Calculate BMI
            !smoker &&
            activityMinutes >= 30 &&
            activityMinutes <= 60 &&
            saltContent < 50 &&
            alcoholUnits === 50 &&
            stressLevel === 'Low' &&
            !kidneyDisease
        ) {
            bloodPressure = 'Normal Blood Pressure';
        } else {
            bloodPressure = 'Abnormal Blood Pressure';
        }

        results.healthStatus = bloodPressure;

        if (bloodPressure === 'Normal Blood Pressure') {
            results.recommendation = 'Maintain a healthy lifestyle.';
        } else {
            results.recommendation = 'Consult a healthcare professional for further evaluation.';
        }
    }

    Alpine.store('calculateBloodPressure', calculateBloodPressure);

    </script>
    <script>
        const openButton = document.getElementById('open-notifications');
        const notificationsContent = document.querySelector('.notifications-content');

        openButton.addEventListener('click', () => {
            notificationsContent.style.display = notificationsContent.style.display === 'block' ? 'none' : 'block';
        });

        // Close notifications when clicking outside the tab
        document.addEventListener('click', (event) => {
            if (!notificationsContent.contains(event.target) && event.target !== openButton) {
                notificationsContent.style.display = 'none';
            }
        });
        const notification = document.createElement('div');
        notification.classList.add('notification');
        notification.innerHTML = `
            <p>You have a new message!</p>
            <span class="timestamp">2 minutes ago</span>
            `;
        notificationsContent.appendChild(notification);
    </script>
</body>
</html>